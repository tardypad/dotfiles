#! /usr/bin/env zsh

TITLE="$1"
ENV_NAME="$2"

ENV_PATH="${XDG_CONFIG_HOME:-$HOME/.config}/tmux/env/${ENV_NAME}"

SESSIONS=($(
  print -l -- NEW "${ENV_PATH}"/*.sh(:t:r) \
  | fzf --reverse \
        --multi \
        --margin 1,2,0,2 \
        --prompt 'open sessions ' \
        --color info:{color/background/number} \
))

[[ -n "${SESSIONS}" ]] || exit

(( ${SESSIONS[(Ie)NEW]} )) && SESSIONS=

app_tmux_env "${TITLE}" "${ENV_NAME}" ${SESSIONS}
