#! /usr/bin/env zsh

TITLE='ïƒ  Mail client'

# try to focus existing window if it exists
focus_window_title "${TITLE}" && exit

# launch new app otherwise
# needs a shell started before to have correct GPG_TTY
# so that the pinentry is displayed in the new terminal
swaymsg -t command \
  exec "termite \
          --title \"${TITLE}\" \
          --exec 'tmux new-session \"neomutt\" \; rename-session \"neomutt #{s/$//:session_id}\"'"

# focus the window (not automatic if different workspace)
# need to wait a bit for the window to be registered
sleep 0.1
focus_window_title "${TITLE}"
