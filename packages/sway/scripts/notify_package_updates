#!/usr/bin/env zsh

MESSAGE=

PACMAN_UPDATES_COUNT=$(
  checkupdates \
    | wc -l
)
if [[ "${PACMAN_UPDATES_COUNT}" -gt 0 ]]; then
  MESSAGE+="pacman: ${PACMAN_UPDATES_COUNT}\n"
fi

AUR_UPDATES_COUNT=$(
  aur repo --database aur --sync --upgrades \
    | wc -l
)
if [[ "${AUR_UPDATES_COUNT}" -gt 0 ]]; then
  MESSAGE+="aur: ${AUR_UPDATES_COUNT}\n"
fi

TARDYPAD_UPDATES_COUNT=$(
  aur repo --database tardypad --sync --upgrades \
    | wc -l
)
if [[ "${TARDYPAD_UPDATES_COUNT}" -gt 0 ]]; then
  MESSAGE+="tardypad: ${TARDYPAD_UPDATES_COUNT}\n"
fi

# exit if no updates available
[[ -n "${MESSAGE}" ]] || exit

notify-send \
  --category 'info' \
  'Packages updates available' \
  "${MESSAGE}"
